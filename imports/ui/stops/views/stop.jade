template(name="stop")
  if Template.subscriptionsReady
    .tour-stop
      if stop.childStops
        h1.group-title
          span.stopNumber #{stop.stopNumber}
          | #{stop.title}
        ul.child-stops
          each childStops
            li.child-stop
              .child-stop-info
                h2.tap-list-title.child-stop-title
                  span
                    span.child-stop-number #{stop.stopNumber}.#{order}
                    span #{title}
                unless isNull speaker
                  p.child-stop-subTitle #{speaker}
              +stopContent stop=this
      else
        h1.single-title
          span.stopNumber #{stop.stopNumber}
          | #{stop.title}
        unless isNull stop.speaker
          p.child-stop-subTitle.single #{stop.speaker}
        +stopContent stop=stop
      .stop-nav
        .col-xs-6
            a.stop-nav-button.prev-stop(href="#" disabled="{{#unless prevStop}} disabled {{/unless}}")
              i.fa.fa-chevron-circle-left
              span Previous stop

        .col-xs-6
            a.stop-nav-button.next-stop(href="#" disabled="{{#unless nextStop}} disabled {{/unless}}")
              span Next stop
              i.fa.fa-chevron-circle-right
  else
    .loading

template(name="stopContent")
  if isVideo
    .video-wrap
      video(
        src="http:#{awsUrl}/#{stop.tour}/#{stop.media}"
        poster="{{posterImage}}"
        controls
        autoplay="{{autoplay}}")
  else if isAudio
    .video-wrap
      video(
        src="http:#{awsUrl}/#{stop.tour}/#{stop.media}"
        poster="#{awsUrl}/#{audioType}-poster.png"
        controls
        autoplay="{{autoplay}}"
        class="{{audioType}}")
  else
    .img-wrap
      img(src="https://s3.amazonaws.com/tap-cma/#{stop.tour}/#{stop.media}" controls)

